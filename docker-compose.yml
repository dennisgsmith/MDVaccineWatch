version: "3.9"

# Use for local testing
services:
  # Build backend
  scheduler:
    container_name: MDVaccineWatch-backend
    build: ./backend
    environment:
      # Allow unbuffered stream for logs
      - PYTHONUNBUFFERED="stout"
      - AWS_S3_BUCKET
      - AWS_DEFAULT_REGION
      - MB_TOKEN
    # DEV
    volumes:
      - ${HOME}/.aws/credentials:/root/.aws/credentials:ro

  # Build webapp
  app:
    container_name: MDVaccineWatch-app
    build: ./app
    environment:
      - AWS_S3_BUCKET
      - AWS_DEFAULT_REGION
      - MB_TOKEN
    # DEV
    volumes:
      - ${HOME}/.aws/credentials:/root/.aws/credentials:ro
    ports:
      - 8050:8050
    depends_on:
      - scheduler
